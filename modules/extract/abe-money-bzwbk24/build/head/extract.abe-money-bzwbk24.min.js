var g_headers={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","Accept-Charset":"windows-1251,utf-8;q=0.7,*;q=0.3","Accept-Language":"ru-RU,ru;q=0.8,en-US;q=0.6,en;q=0.4",Connection:"keep-alive","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"},baseurl="https://www.centrum24.pl/centrum24-web/";
function login(){var c=AnyBalance.getPreferences();AnyBalance.setDefaultCharset("utf-8");checkEmpty(c.login,"Wpisz NIK!");checkEmpty(c.password,"Wpisz hasło (PIN)!");var a=AnyBalance.requestGet(baseurl+"portfolio",g_headers);if(!a||400<AnyBalance.getLastStatusCode())throw AnyBalance.trace(a),new AnyBalance.Error("Error connecting internet-bank! Try again later.");if(/logout/i.test(a))AnyBalance.trace("Already logged in. Reusing previous session.");else{var b=getParam(a,/\{[^}]*"nikForm"[^}]*\}/i,
null,getJson);if(!b)throw AnyBalance.trace(a),new AnyBalance.Error("Could not find login form. Is site changed?");var a=b.u,b=AnyBalance.getLastUrl(),a=AnyBalance.requestPost(joinUrl(baseurl,a),{nikForm_hf_0:"",nik:c.login,loginButton:"1"},addHeaders({Referer:b,"X-Requested-With":"XMLHttpRequest","Wicket-Ajax":"true","Wicket-Ajax-BaseURL":getParam(b,/[^\/]*$/),"Wicket-FocusedElementId":"okBtn2"})),d=getElement(a,/<redirect/i,[/<!\[CDATA\[|\]\]>/g,"",replaceTagsAndSpaces]);if(!d)throw AnyBalance.trace(a),
new AnyBalance.Error("Could not redirect to entering password. Is site changed?");a=AnyBalance.requestGet(joinUrl(b,d),addHeaders({Referer:b}));b=getElement(a,/<form[^>]+id="pinForm"[^>]*>/i);if(!b){if(b=getElement(a,/<li[^>]+feedbackPanelERROR[^>]*>|<div[^>]+logErrorMessage[^>]*>/i,replaceTagsAndSpaces))throw new AnyBalance.Error("NIK: "+b,null,/incorrect|nieprawid|NIK|PIN/i.test(b));if(/<form[^>]+nikForm/i.test(a))throw new AnyBalance.Error("Incorrect NIK",null,!0);AnyBalance.trace(a);throw new AnyBalance.Error("Could not find PIN form. Is site changed?");
}params=createFormParams(b,function(a,b,d,h){return"pinFragment:pin"==d?c.password:h});a=getParam(b,null,null,/<form[^>]+action="\.+\/([^"]*)/i,AB.replaceHtmlEntities);a=AnyBalance.requestPost(joinUrl(baseurl,a),params,addHeaders({Referer:AnyBalance.getLastUrl()}))}if(!/logout/i.test(a)){(b=getElement(a,/<li[^>]+feedbackPanelERROR[^>]*>|<div[^>]+logErrorMessage[^>]*>/i,replaceTagsAndSpaces))||(b=getElement(a,/<div[^>]+error/i,replaceTagsAndSpaces));if(b)throw new AnyBalance.Error(b,null,/incorrect|nieprawid|NIK|PIN/i.test(b));
AnyBalance.trace(a);throw new AnyBalance.Error("Could not log into internet bank. Is the site changed?");}/<li[^>]+id="menu_portfel_24"[^>]+class="selected"/i.test(a)||(AnyBalance.trace("Portfel is not selected. Selecting it explicitly."),a=AnyBalance.requestGet(baseurl+"portfolio",g_headers));__setLoginSuccessful();return a}
function processAccounts(c,a){if(AnyBalance.isAvailable("accounts")){var b=getElement(c,/<div[^>]+avistaAccountsBoxContent[^>]*>/i);if(b)if(b=getElement(b,/<tbody[^>]*>/i),b=getElements(b,/<tr[^>]*>/ig),b.length)for(AnyBalance.trace("Найдено счетов: "+b.length),a.accounts=[],c=0;c<b.length;++c){var d=b[c],f=getParam(d,null,null,/(?:[\s\S]*?<td[^>]*>){1}([\s\S]*?)<\/td>/i),e=getElement(f,/<em[^>]*>/i,replaceTagsAndSpaces),f=getElement(f,/<a[^>]*>/i,replaceTagsAndSpaces),e={__id:e,__name:f+" "+e.substr(-4),
num:e,name:f};__shouldProcess("accounts",e)&&processAccount(d,e);a.accounts.push(e)}else AnyBalance.trace("У вас нет счетов"),a.accounts=[];else AnyBalance.trace(c),AnyBalance.trace("You possibly do not have accounts")}}
function processAccount(c,a){AnyBalance.trace("Обработка счета "+a.__name);getParam(c,a,"accounts.available",/(?:[\s\S]*?<td[^>]*>){2}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseBalance);getParam(c,a,"accounts.balance",/(?:[\s\S]*?<td[^>]*>){3}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseBalance);getParam(c,a,["accounts.currency","accounts.balance","accounts.available"],/(?:[\s\S]*?<td[^>]*>){3}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseCurrency);if(AnyBalance.isAvailable("accounts.limit","accounts.pct",
"accounts.last_transaction_date")){var b=getParam(getElements(c,[/<a[^>]+>/ig,/Szczegóły|Details|Detalles/i])[0],null,null,/<a[^>]+href="([^"]*)/i,replaceHtmlEntities),b=AnyBalance.requestGet(baseurl+"portfolio"+b,g_headers);getParam(b,a,"accounts.limit",/(?:Credit limit|Limit kredytowy|Límite de crédito)[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseBalance);getParam(b,a,"accounts.pct",/(?:Interest rate|Oprocentowanie|Tasa de interés)[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,
parseBalance);getParam(b,a,"accounts.last_transaction_date",/(?:Last transaction date|Data ostatniej operacji|Fecha de última operación)[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseDateISO)}AnyBalance.isAvailable("accounts.transactions")&&processAccountTransactions(c,a)}
function processCards(c,a){if(AnyBalance.isAvailable("cards")){c=AnyBalance.requestGet(baseurl+"cards",g_headers);var b=getElement(c,/<div[^>]+debitCardsBoxContent[^>]*>/i);if(b)if(b=getElement(b,/<tbody[^>]*>/i),b=getElements(b,/<tr[^>]*>/ig),b.length)for(AnyBalance.trace("Найдено карт: "+b.length),a.cards=[],c=0;c<b.length;++c){var d=b[c],f=getParam(d,null,null,/(?:[\s\S]*?<td[^>]*>){1}([\s\S]*?)<\/td>/i),e=getElement(f,/<em[^>]*>/i,replaceTagsAndSpaces),f=getElement(f,/<a[^>]*>/i,replaceTagsAndSpaces),
g=getParam(d,null,null,/(?:[\s\S]*?<td[^>]*>){2}([\s\S]*?)<\/td>/i),g=getParam(g,null,null,/<br[^>]*>([\s\S]*)/i,replaceTagsAndSpaces),e={__id:g,__name:f+" "+g.substr(-4),num:g,name:f,accnum:e};__shouldProcess("cards",e)&&processCard(d,e);a.cards.push(e)}else AnyBalance.trace("У вас нет счетов"),a.accounts=[];else AnyBalance.trace(c),AnyBalance.trace("You possibly do not have debit cards")}}
function processCard(c,a){AnyBalance.trace("Обработка карты "+a.__name);getParam(c,a,["cards.currency","cards.balance","cards.available"],/(?:[\s\S]*?<td[^>]*>){3}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces);if(AnyBalance.isAvailable("cards.holder","cards.status")){var b=getParam(getElements(c,[/<a[^>]+>/ig,/Szczegóły|Details|Detalles/i])[0],null,null,/<a[^>]+href="([^"]*)/i,replaceHtmlEntities),b=AnyBalance.requestGet(baseurl+"portfolio"+b,g_headers);getParam(b,a,"cards.holder",/(?:Name and surname|Imię i nazwisko|Nombre y apellido):[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/i,
replaceTagsAndSpaces);getParam(b,a,"cards.status",/(?:Status|Estado):[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/i,replaceTagsAndSpaces)}AnyBalance.isAvailable("cards.transactions")&&processCardTransactions(c,a)}function processDeposits(c,a){AnyBalance.isAvailable("deposits")}function processDeposit(c,a,b){AnyBalance.trace("Обработка депозита "+a.__name)}function processCredits(c,a){AnyBalance.isAvailable("credits")}
function processCredit(c,a,b){AnyBalance.trace("Обработка кредита "+a.__name);AnyBalance.isAvailable("credits.transactions")&&processCreditTransactions(c,a);AnyBalance.isAvailable("credits.schedule")&&processCreditSchedule(c,a)}
function processInfo(c,a){c=AnyBalance.requestGet(baseurl+"yourData",g_headers);a=a.info={};var b=getElement(c,/<select[^>]+mobilePhoneNumberPanel:phoneNumberPrefix[^>]*>/i),b=getElement(b,/<option[^>]+selected[^>]*>/i,replaceTagsAndSpaces),d=create_aggregate_join("");sumParam(b,a,"info.mphone",/\(([^)]*)\)/,null,null,d);sumParam(c,a,"info.mphone",/<input[^>]*mobilePhoneNumberPanel:phoneNumber\b[^>]*value="([^"]*)/,replaceTagsAndSpaces,null,d);getParam(c,a,"info.email",/<input[^>]*emailMailInpBorder:emailMailInp\b[^>]*value="([^"]*)/,
replaceTagsAndSpaces);getParam(c,a,"info.fio",/<span[^>]+label[^>]*>\s*(?:Name|Nazwa|Nombre)[\s\S]*?<span[^>]*>([\s\S]*?)<\/span>/i,replaceTagsAndSpaces);getParam(c,a,"info.address_street",/<span[^>]+label[^>]*>\s*(?:Street|Ulica|Calle)[\s\S]*?<span[^>]*>([\s\S]*?)<\/span>/i,replaceTagsAndSpaces);getParam(c,a,"info.address_zip",/<span[^>]+label[^>]*>\s*(?:Postal code|Kod pocztowy|Código postal)[\s\S]*?<span[^>]*>([\s\S]*?)<\/span>/i,replaceTagsAndSpaces);getParam(c,a,"info.address_city",/<span[^>]+label[^>]*>\s*(?:City|Miejscowość|Localidad)[\s\S]*?<span[^>]*>([\s\S]*?)<\/span>/i,
replaceTagsAndSpaces);getParam(getElement(c,/<select[^>]+countryHomeChoiceBorder:countryHomeChoice[^>]*>/i),a,"info.address_country",/<option[^>]+selected[^>]*value="([^"]*)/i,replaceHtmlEntities);getParam(getElement(c,/<select[^>]+citizenshipChoiceBorder:citizenshipChoice[^>]*>/i),a,"info.nationality",/<option[^>]+selected[^>]*value="([^"]*)/i,replaceHtmlEntities);getParam(getElement(c,/<select[^>]+birthCountryChoiceBorder:birthCountryChoice[^>]*>/i),a,"info.birth_country",/<option[^>]+selected[^>]*value="([^"]*)/i,
replaceHtmlEntities)};
