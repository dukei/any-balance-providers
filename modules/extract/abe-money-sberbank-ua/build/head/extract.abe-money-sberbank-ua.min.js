var g_headers={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8","Accept-Language":"ru,en-US;q=0.8,en;q=0.6,uk;q=0.4",Connection:"keep-alive",Origin:"https://online.oschadbank.ua","User-Agent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.111 Safari/537.36"},baseurl="https://online.oschadbank.ua/",gDataJson;
function login(b,a){AnyBalance.setDefaultCharset("utf-8");checkEmpty(b.login,"Введіть логін!");checkEmpty(b.password,"Введіть пароль!");var c;AnyBalance.requestGet(baseurl+"wb/",g_headers);c=AnyBalance.requestGet(baseurl+"wb/api/v2/session",addHeaders({Referer:baseurl+"wb/","X-Requested-With":"XMLHttpRequest"}));a=getJson(c);if("authenticated"!=a.status){c=AnyBalance.requestPost(baseurl+"wb/api/v2/session",JSON.stringify({login:b.login,password:b.password,captcha:""}),addHeaders({Referer:baseurl+
"wb/","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}));a=getJson(c);if("confirmationRequired"==a._status){AnyBalance.trace("Потребовалась доп. авторизация: "+c);if(a.confirmation.authTypes){AnyBalance.trace("Выбираем способ подтверждения...");if(0>a.confirmation.authTypes.indexOf("otp_sms"))throw AnyBalance.trace(c),new AnyBalance.Error("Ни один способ доп. подтверждения входа, требуемый данным логином, пока не поддерживается. Сайт изменен?");a._status=null;a.captcha="";a.login=
b.login;a.password=b.password;a.confirmation.authType="otp_sms";a.confirmation.phoneId=a.confirmation.phones[0].id;c=AnyBalance.requestPost(baseurl+"wb/api/v2/session",JSON.stringify(a),addHeaders({Referer:baseurl+"wb/","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}));a=getJson(c)}c=AnyBalance.retrieveCode("На ваш телефонний номер "+a.confirmation.challenge.phone+" відправлено СМС-повідомлення з одноразовим паролем. Будь ласка, введіть пароль",null,{inputType:"number",time:18E4});
AnyBalance.trace("Отправляем код подтверждения...");a._status=null;a.captcha="";a.login=b.login;a.password=b.password;a.confirmation.response=c;c=AnyBalance.requestPost(baseurl+"wb/api/v2/session",JSON.stringify(a),addHeaders({Referer:baseurl+"wb/","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}));a=getJson(c)}if("authenticated"!=a.status){b={INVALID_ONE_TIME_PASSWORD:"Невірний одноразовий пароль",INVALID_LOGIN_OR_PASSWORD:"Невірний логін або пароль"};if(a._error)throw new AnyBalance.Error(b[a._error.code]||
a._error.code,null,/INVALID_LOGIN_OR_PASSWORD/i.test(a._error.code));AnyBalance.trace(c);throw new AnyBalance.Error("Не удалось войти в интернет банк. Сайт изменен?");}}else AnyBalance.trace("Используем существующую сессию");__setLoginSuccessful();return a}function processProfile(b,a){b=getProductJson();for(var c=0;c<b.length;++c){var d=b[c];if(d.owner){a.profile={};getParam(d.owner.fullName,a.profile,"profile.fio");getParam(d.owner.itn,a.profile,"profile.itn");break}}}
function processCards(b,a){b=getProductJson("card");AnyBalance.trace("Найдено карт: "+b.length);a.cards=[];for(var c=0;c<b.length;++c){var d=b[c],e=d.number,e={__id:d.id,__name:e,num:e};__shouldProcess("cards",e)&&processCard(d,e);a.cards.push(e)}}
function processCard(b,a){getParam(b.balances.available.value,a,"cards.balance",null,null,parseBalance);b.balances.full_crlimit&&getParam(b.balances.full_crlimit.value,a,"cards.maxlimit",null,null,parseBalance);getParam(b.card.expiryDate+"",a,"cards.till",null,null,parseDate);b.balances.total_due&&getParam(b.balances.total_due.value,a,"cards.debt",null,null,parseBalance);getParam(b.balances["06"].value,a,"cards.mz",null,null,parseBalance);getParam(b.card.accountNumber,a,"cards.rr");getParam(b.balances.available.currency,
a,["cards.currency","cards.balance","cards.maxlimit","cards.debt","cards.mz"]);getParam(b.number,a,"cards.cardNumber");"undefined"!=typeof processCardTransactions&&processCardTransactions(b,a)}function processAccounts(b,a){b=getProductJson("cardAccount");AnyBalance.trace("Найдено счетов: "+b.length);a.accounts=[];for(var c=0;c<b.length;++c){var d=b[c],e=d.number,e={__id:d.id,__name:e,num:e};__shouldProcess("accounts",e)&&processAccount(d,e);a.accounts.push(e)}}
function processAccount(b,a){getParam(b.balances.available.value,a,"accounts.balance",null,null,parseBalance);getParam(b.balances.full_crlimit.value,a,"accounts.maxlimit",null,null,parseBalance);getParam(b.balances.total_due.value,a,"accounts.debt",null,null,parseBalance);getParam(b.balances["06"].value,a,"accounts.mz",null,null,parseBalance);getParam(b.cardAccount.accountNumber,a,"accounts.rr");getParam(b.balances.available.currency,a,["accounts.currency","accounts.balance","accounts.maxlimit","accounts.debt",
"accounts.mz"]);"undefined"!=typeof processAccountTransactions&&processAccountTransactions(b,a)}function getProductJson(b){if(gDataJson)a=gDataJson;else var a=AnyBalance.requestGet(baseurl+"wb/api/v2/contracts?system=W4C",addHeaders({"X-Requested-With":"XMLHttpRequest"})),a=gDataJson=getJson(a);return isset(b)?a.filter(function(a){return a.type==b}):a}function sortByKey(b,a){return b.sort(function(b,d){b=b[a];d=d[a];return b>d?-1:b<d?1:0})};
