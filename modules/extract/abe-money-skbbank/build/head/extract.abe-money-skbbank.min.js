mask=bpe=0;radix=mask+1;digitsStr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_=!@#$%^&*()[]{}|;:,.<>/?`~ \\'\"+-";for(bpe=0;1<<bpe+1>1<<bpe;bpe++);bpe>>=1;mask=(1<<bpe)-1;radix=mask+1;one=int2bigInt(1,1,1);s_aa=s_x2=s_x1=s_d=s_b=s_n=s_r2=s_a=s_n1=s_q=s_rm=s_R=s_i2=s_i=pows=primes=md_tt=md_r2=md_r1=md_r=md_q3=md_q2=md_q1=eg_D=eg_C=eg_B=eg_A=eg_u=eg_v=mr_a=mr_r=mr_x1=sa=T=s7=s6=s5=s4=s3=s2=s1=s0=ss=t=[];
function findPrimes(a){var b,c,d;c=Array(a);for(b=0;b<a;b++)c[b]=0;c[0]=2;for(d=0;c[d]<a;){for(b=c[d]*c[d];b<a;b+=c[d])c[b]=1;d++;for(c[d]=c[d-1]+1;c[d]<a&&c[c[d]];c[d]++);}a=Array(d);for(b=0;b<d;b++)a[b]=c[b];return a}
function millerRabin(a,b){var c,d,e;mr_x1.length!=a.length&&(mr_x1=dup(a),mr_r=dup(a),mr_a=dup(a));copyInt_(mr_a,b);copy_(mr_r,a);copy_(mr_x1,a);addInt_(mr_r,-1);addInt_(mr_x1,-1);for(b=d=0;b<mr_r.length;b++)for(c=1;c<mask;c<<=1)a[b]&c?(e=d<mr_r.length+bpe?d:0,b=mr_r.length,c=mask):d++;e&&rightShift_(mr_r,e);powMod_(mr_a,mr_r,a);if(!equalsInt(mr_a,1)&&!equals(mr_a,mr_x1)){for(c=1;c<=e-1&&!equals(mr_a,mr_x1);){squareMod_(mr_a,a);if(equalsInt(mr_a,1))return 0;c++}if(!equals(mr_a,mr_x1))return 0}return 1}
function bitSize(a){var b,c;for(b=a.length-1;0==a[b]&&0<b;b--);c=0;for(a=a[b];a;a>>=1,c++);return c+=bpe*b}function expand(a,b){b=int2bigInt(0,(a.length>b?a.length:b)*bpe,0);copy_(b,a);return b}function randTruePrime(a){var b=int2bigInt(0,a,0);randTruePrime_(b,a);return trim(b,1)}function mod(a,b){a=dup(a);mod_(a,b);return trim(a,1)}function addInt(a,b){a=expand(a,a.length+1);addInt_(a,b);return trim(a,1)}function mult(a,b){a=expand(a,a.length+b.length);mult_(a,b);return trim(a,1)}
function powMod(a,b,c){a=expand(a,c.length);powMod_(a,trim(b,2),trim(c,2),0);return trim(a,1)}function sub(a,b){a=expand(a,a.length>b.length?a.length+1:b.length+1);sub_(a,b);return trim(a,1)}function add(a,b){a=expand(a,a.length>b.length?a.length+1:b.length+1);add_(a,b);return trim(a,1)}function inverseMod(a,b){a=expand(a,b.length);return inverseMod_(a,b)?trim(a,1):null}function multMod(a,b,c){a=expand(a,c.length);multMod_(a,b,c);return trim(a,1)}
function randTruePrime_(a,b){var c,d,e;0==primes.length&&(primes=findPrimes(3E4));if(0==pows.length)for(pows=Array(512),e=0;512>e;e++)pows[e]=Math.pow(2,e/511-1);recLimit=20;s_i2.length!=a.length&&(s_i2=dup(a),s_R=dup(a),s_n1=dup(a),s_r2=dup(a),s_d=dup(a),s_x1=dup(a),s_x2=dup(a),s_b=dup(a),s_n=dup(a),s_i=dup(a),s_rm=dup(a),s_q=dup(a),s_a=dup(a),s_aa=dup(a));if(b<=recLimit){c=(1<<(b+2>>1))-1;copyInt_(a,0);for(d=1;d;)for(d=0,a[0]=1|1<<b-1|Math.floor(Math.random()*(1<<b)),e=1;e<primes.length&&(primes[e]&
c)==primes[e];e++)if(0==a[0]%primes[e]){d=1;break}carry_(a)}else{c=.1*b*b;if(40<b)for(e=1;20>=b-b*e;)e=pows[Math.floor(512*Math.random())];else e=.5;e=Math.floor(e*b)+1;randTruePrime_(s_q,e);copyInt_(s_i2,0);s_i2[Math.floor((b-2)/bpe)]|=1<<(b-2)%bpe;divide_(s_i2,s_q,s_i,s_rm);for(b=bitSize(s_i);;){for(;randBigInt_(s_R,b,0),!greater(s_i,s_R););addInt_(s_R,1);add_(s_R,s_i);copy_(s_n,s_q);mult_(s_n,s_R);multInt_(s_n,2);addInt_(s_n,1);copy_(s_r2,s_R);multInt_(s_r2,2);for(e=d=0;e<primes.length&&primes[e]<
c;e++)if(0==modInt(s_n,primes[e])){d=1;break}d||millerRabin(s_n,2)||(d=1);if(!d){addInt_(s_n,-3);for(e=s_n.length-1;0==s_n[e]&&0<e;e--);d=0;for(w=s_n[e];w;w>>=1,d++);for(d+=bpe*e;randBigInt_(s_a,d,0),!greater(s_n,s_a););addInt_(s_n,3);addInt_(s_a,2);copy_(s_b,s_a);copy_(s_n1,s_n);addInt_(s_n1,-1);powMod_(s_b,s_n1,s_n);addInt_(s_b,-1);if(isZero(s_b)&&(copy_(s_b,s_a),powMod_(s_b,s_r2,s_n),addInt_(s_b,-1),copy_(s_aa,s_n),copy_(s_d,s_b),GCD_(s_d,s_n),equalsInt(s_d,1))){copy_(a,s_aa);break}}}}}
function randBigInt(a,b){var c;c=int2bigInt(0,0,Math.floor((a-1)/bpe)+2);randBigInt_(c,a,b);return c}function randBigInt_(a,b,c){var d,e;for(d=0;d<a.length;d++)a[d]=0;e=Math.floor((b-1)/bpe)+1;for(d=0;d<e;d++)a[d]=Math.floor(Math.random()*(1<<bpe-1));a[e-1]&=(2<<(b-1)%bpe)-1;1==c&&(a[e-1]|=1<<(b-1)%bpe)}function GCD(a,b){a=dup(a);b=dup(b);GCD_(a,b);return a}
function GCD_(a,b){var c,d,e,f,g,h,m,l;T.length!=a.length&&(T=dup(a));for(l=1;l;){l=0;for(c=1;c<b.length;c++)if(b[c]){l=1;break}if(!l)break;for(c=a.length;!a[c]&&0<=c;c--);d=a[c];c=b[c];e=1;g=f=0;for(h=1;c+g&&c+h;){m=Math.floor((d+e)/(c+g));qp=Math.floor((d+f)/(c+h));if(m!=qp)break;t=e-m*g;e=g;g=t;t=f-m*h;f=h;h=t;t=d-m*c;d=c;c=t}f?(copy_(T,a),linComb_(a,b,e,f),linComb_(b,T,h,g)):(mod_(a,b),copy_(T,a),copy_(a,b),copy_(b,T))}if(0!=b[0])for(t=modInt(a,b[0]),copyInt_(a,b[0]),b[0]=t;b[0];)a[0]%=b[0],t=
a[0],a[0]=b[0],b[0]=t}
function inverseMod_(a,b){var c=1+2*Math.max(a.length,b.length);if(!(a[0]&1||b[0]&1))return copyInt_(a,0),0;eg_u.length!=c&&(eg_u=Array(c),eg_v=Array(c),eg_A=Array(c),eg_B=Array(c),eg_C=Array(c),eg_D=Array(c));copy_(eg_u,a);copy_(eg_v,b);copyInt_(eg_A,1);copyInt_(eg_B,0);copyInt_(eg_C,0);for(copyInt_(eg_D,1);;){for(;!(eg_u[0]&1);)halve_(eg_u),eg_A[0]&1||eg_B[0]&1?(add_(eg_A,b),halve_(eg_A),sub_(eg_B,a)):halve_(eg_A),halve_(eg_B);for(;!(eg_v[0]&1);)halve_(eg_v),eg_C[0]&1||eg_D[0]&1?(add_(eg_C,b),halve_(eg_C),
sub_(eg_D,a)):halve_(eg_C),halve_(eg_D);greater(eg_v,eg_u)?(sub_(eg_v,eg_u),sub_(eg_C,eg_A),sub_(eg_D,eg_B)):(sub_(eg_u,eg_v),sub_(eg_A,eg_C),sub_(eg_B,eg_D));if(equalsInt(eg_u,0))return negative(eg_C)&&add_(eg_C,b),copy_(a,eg_C),equalsInt(eg_v,1)?1:(copyInt_(a,0),0)}}function inverseModInt(a,b){for(var c=1,d=0;;){if(1==a)return c;if(0==a)return 0;d-=c*Math.floor(b/a);b%=a;if(1==b)return d;if(0==b)return 0;c-=d*Math.floor(a/b);a%=b}}function inverseModInt_(a,b){return inverseModInt(a,b)}
function eGCD_(a,b,c,d,e){var f=0,g=Math.max(a.length,b.length);eg_u.length!=g&&(eg_u=Array(g),eg_A=Array(g),eg_B=Array(g),eg_C=Array(g),eg_D=Array(g));for(;!(a[0]&1||b[0]&1);)halve_(a),halve_(b),f++;copy_(eg_u,a);copy_(c,b);copyInt_(eg_A,1);copyInt_(eg_B,0);copyInt_(eg_C,0);for(copyInt_(eg_D,1);;){for(;!(eg_u[0]&1);)halve_(eg_u),eg_A[0]&1||eg_B[0]&1?(add_(eg_A,b),halve_(eg_A),sub_(eg_B,a)):halve_(eg_A),halve_(eg_B);for(;!(c[0]&1);)halve_(c),eg_C[0]&1||eg_D[0]&1?(add_(eg_C,b),halve_(eg_C),sub_(eg_D,
a)):halve_(eg_C),halve_(eg_D);greater(c,eg_u)?(sub_(c,eg_u),sub_(eg_C,eg_A),sub_(eg_D,eg_B)):(sub_(eg_u,c),sub_(eg_A,eg_C),sub_(eg_B,eg_D));if(equalsInt(eg_u,0)){negative(eg_C)&&(add_(eg_C,b),sub_(eg_D,a));multInt_(eg_D,-1);copy_(d,eg_C);copy_(e,eg_D);leftShift_(c,f);break}}}function negative(a){return a[a.length-1]>>bpe-1&1}
function greaterShift(a,b,c){var d=a.length,e=b.length;k=d+c<e?d+c:e;for(i=e-1-c;i<d&&0<=i;i++)if(0<a[i])return 1;for(i=d-1+c;i<e;i++)if(0<b[i])return 0;for(i=k-1;i>=c;i--){if(a[i-c]>b[i])return 1;if(a[i-c]<b[i])break}return 0}function greater(a,b){var c,d=a.length<b.length?a.length:b.length;for(c=a.length;c<b.length;c++)if(b[c])return 0;for(c=b.length;c<a.length;c++)if(a[c])return 1;for(c=d-1;0<=c;c--){if(a[c]>b[c])return 1;if(a[c]<b[c])break}return 0}
function divide_(a,b,c,d){var e,f,g,h,m;copy_(d,a);for(a=b.length;0==b[a-1];a--);e=b[a-1];for(m=0;e;m++)e>>=1;m=bpe-m;leftShift_(b,m);leftShift_(d,m);for(e=d.length;0==d[e-1]&&e>a;e--);for(copyInt_(c,0);!greaterShift(b,d,e-a);)subShift_(d,b,e-a),c[e-a]++;for(--e;e>=a;e--){for(c[e-a]=d[e]==b[a-1]?mask:Math.floor((d[e]*radix+d[e-1])/b[a-1]);;)if(g=(1<a?b[a-2]:0)*c[e-a],h=g>>bpe,g&=mask,f=h+c[e-a]*b[a-1],h=f>>bpe,f&=mask,h==d[e]?f==d[e-1]?g>(1<e?d[e-2]:0):f>d[e-1]:h>d[e])c[e-a]--;else break;linCombShift_(d,
b,-c[e-a],e-a);negative(d)&&(addShift_(d,b,e-a),c[e-a]--)}rightShift_(b,m);rightShift_(d,m)}function carry_(a){var b,c,d,e;c=a.length;for(b=d=0;b<c;b++)d+=a[b],e=0,0>d&&(e=-(d>>bpe),d+=e*radix),a[b]=d&mask,d=(d>>bpe)-e}function modInt(a,b){var c,d=0;for(c=a.length-1;0<=c;c--)d=(d*radix+a[c])%b;return d}function int2bigInt(a,b,c){b=Math.ceil(b/bpe)+1;buff=Array(c>b?c:b);copyInt_(buff,a);return buff}
function str2bigInt(a,b,c){var d,e,f,g=a.length;if(-1==b){for(f=[];;){b=Array(f.length+1);for(e=0;e<f.length;e++)b[e+1]=f[e];b[0]=parseInt(a,10);f=b;d=a.indexOf(",",0);if(1>d)break;a=a.substring(d+1);if(0==a.length)break}return f.length<c?(b=Array(c),copy_(b,f),b):f}f=int2bigInt(0,b*g,0);for(e=0;e<g;e++)d=digitsStr.indexOf(a.substring(e,e+1),0),36>=b&&36<=d&&(d-=26),d<b&&0<=d&&(multInt_(f,b),addInt_(f,d));for(g=f.length;0<g&&!f[g-1];g--);g=c>g+1?c:g+1;b=Array(g);a=g<f.length?g:f.length;for(e=0;e<
a;e++)b[e]=f[e];for(;e<g;e++)b[e]=0;return b}function equalsInt(a,b){if(a[0]!=b)return 0;for(b=1;b<a.length;b++)if(a[b])return 0;return 1}function equals(a,b){var c,d=a.length<b.length?a.length:b.length;for(c=0;c<d;c++)if(a[c]!=b[c])return 0;if(a.length>b.length)for(;c<a.length;c++){if(a[c])return 0}else for(;c<b.length;c++)if(b[c])return 0;return 1}function isZero(a){var b;for(b=0;b<a.length;b++)if(a[b])return 0;return 1}
function bigInt2str(a,b){var c="";s6.length!=a.length?s6=dup(a):copy_(s6,a);if(-1==b){for(b=a.length-1;0<b;b--)c+=a[b]+",";c+=a[0]}else for(;!isZero(s6);)a=divInt_(s6,b),c=digitsStr.substring(a,a+1)+c;1==c.length%2&&(c="0"+c);return c}function dup(a){buff=Array(a.length);copy_(buff,a);return buff}function copy_(a,b){var c,d=a.length<b.length?a.length:b.length;for(c=0;c<d;c++)a[c]=b[c];for(c=d;c<a.length;c++)a[c]=0}function copyInt_(a,b){var c;c=b;for(b=0;b<a.length;b++)a[b]=c&mask,c>>=bpe}
function addInt_(a,b){var c,d,e;a[0]+=b;c=a.length;for(b=d=0;b<c&&(d+=a[b],e=0,0>d&&(e=-(d>>bpe),d+=e*radix),a[b]=d&mask,d=(d>>bpe)-e,d);b++);}function rightShift_(a,b){var c,d=Math.floor(b/bpe);if(d){for(c=0;c<a.length-d;c++)a[c]=a[c+d];for(;c<a.length;c++)a[c]=0;b%=bpe}for(c=0;c<a.length-1;c++)a[c]=mask&(a[c+1]<<bpe-b|a[c]>>b);a[c]>>=b}function halve_(a){var b;for(b=0;b<a.length-1;b++)a[b]=mask&(a[b+1]<<bpe-1|a[b]>>1);a[b]=a[b]>>1|a[b]&radix>>1}
function leftShift_(a,b){var c,d=Math.floor(b/bpe);if(d){for(c=a.length;c>=d;c--)a[c]=a[c-d];for(;0<=c;c--)a[c]=0;b%=bpe}if(b){for(c=a.length-1;0<c;c--)a[c]=mask&(a[c]<<b|a[c-1]>>bpe-b);a[c]=mask&a[c]<<b}}function multInt_(a,b){var c,d,e,f;if(b)for(d=a.length,c=e=0;c<d;c++)e+=a[c]*b,f=0,0>e&&(f=-(e>>bpe),e+=f*radix),a[c]=e&mask,e=(e>>bpe)-f}function divInt_(a,b){var c,d=0;for(c=a.length-1;0<=c;c--)d=d*radix+a[c],a[c]=Math.floor(d/b),d%=b;return d}
function linComb_(a,b,c,d){var e,f,g,h;g=a.length<b.length?a.length:b.length;h=a.length;for(e=f=0;e<g;e++)f+=c*a[e]+d*b[e],a[e]=f&mask,f>>=bpe;for(e=g;e<h;e++)f+=c*a[e],a[e]=f&mask,f>>=bpe}function linCombShift_(a,b,c,d){var e,f,g,h;g=a.length<d+b.length?a.length:d+b.length;h=a.length;f=0;for(e=d;e<g;e++)f+=a[e]+c*b[e-d],a[e]=f&mask,f>>=bpe;for(e=g;f&&e<h;e++)f+=a[e],a[e]=f&mask,f>>=bpe}
function addShift_(a,b,c){var d,e,f,g;f=a.length<c+b.length?a.length:c+b.length;g=a.length;e=0;for(d=c;d<f;d++)e+=a[d]+b[d-c],a[d]=e&mask,e>>=bpe;for(d=f;e&&d<g;d++)e+=a[d],a[d]=e&mask,e>>=bpe}function subShift_(a,b,c){var d,e,f,g;f=a.length<c+b.length?a.length:c+b.length;g=a.length;e=0;for(d=c;d<f;d++)e+=a[d]-b[d-c],a[d]=e&mask,e>>=bpe;for(d=f;e&&d<g;d++)e+=a[d],a[d]=e&mask,e>>=bpe}
function sub_(a,b){var c,d,e;e=a.length<b.length?a.length:b.length;for(c=d=0;c<e;c++)d+=a[c]-b[c],a[c]=d&mask,d>>=bpe;for(c=e;d&&c<a.length;c++)d+=a[c],a[c]=d&mask,d>>=bpe}function add_(a,b){var c,d,e;e=a.length<b.length?a.length:b.length;for(c=d=0;c<e;c++)d+=a[c]+b[c],a[c]=d&mask,d>>=bpe;for(c=e;d&&c<a.length;c++)d+=a[c],a[c]=d&mask,d>>=bpe}function mult_(a,b){var c;ss.length!=2*a.length&&(ss=Array(2*a.length));copyInt_(ss,0);for(c=0;c<b.length;c++)b[c]&&linCombShift_(ss,a,b[c],c);copy_(a,ss)}
function mod_(a,b){s4.length!=a.length?s4=dup(a):copy_(s4,a);s5.length!=a.length&&(s5=dup(a));divide_(s4,b,s5,a)}function multMod_(a,b,c){var d;s0.length!=2*a.length&&(s0=Array(2*a.length));copyInt_(s0,0);for(d=0;d<b.length;d++)b[d]&&linCombShift_(s0,a,b[d],d);mod_(s0,c);copy_(a,s0)}
function squareMod_(a,b){var c,d,e,f;for(f=a.length;0<f&&!a[f-1];f--);c=f>b.length?2*f:2*b.length;s0.length!=c&&(s0=Array(c));copyInt_(s0,0);for(c=0;c<f;c++){e=s0[2*c]+a[c]*a[c];s0[2*c]=e&mask;e>>=bpe;for(d=c+1;d<f;d++)e=s0[c+d]+2*a[c]*a[d]+e,s0[c+d]=e&mask,e>>=bpe;s0[c+f]=e}mod_(s0,b);copy_(a,s0)}function trim(a,b){var c;for(c=a.length;0<c&&!a[c-1];c--);b=Array(c+b);copy_(b,a);return b}
function powMod_(a,b,c){var d,e,f;s7.length!=c.length&&(s7=dup(c));if(0==(c[0]&1))for(copy_(s7,a),copyInt_(a,1);!equalsInt(b,0);)b[0]&1&&multMod_(a,s7,c),divInt_(b,2),squareMod_(s7,c);else{copyInt_(s7,0);for(d=c.length;0<d&&!c[d-1];d--);f=radix-inverseModInt(modInt(c,radix),radix);s7[d]=1;multMod_(a,s7,c);s3.length!=a.length?s3=dup(a):copy_(s3,a);for(d=b.length-1;0<d&!b[d];d--);if(0==b[d])copyInt_(a,1);else{for(e=1<<bpe-1;e&&!(b[d]&e);e>>=1);for(;;){if(!(e>>=1)){d--;if(0>d){mont_(a,one,c,f);break}e=
1<<bpe-1}mont_(a,a,c,f);e&b[d]&&mont_(a,s3,c,f)}}}}function mont_(a,b,c,d){var e,f,g,h,m,l=c.length,q=b.length;for(sa.length!=l&&(sa=Array(l));0<l&&0==c[l-1];l--);copyInt_(sa,0);for(e=0;e<l;e++){m=sa[0]+a[e]*b[0];h=(m&mask)*d&mask;g=m+h*c[0]>>bpe;m=a[e];for(f=1;f<q;f++)g+=sa[f]+m*b[f]+h*c[f],sa[f-1]=g&mask,g>>=bpe;for(;f<l;f++)g+=sa[f]+h*c[f],sa[f-1]=g&mask,g>>=bpe;sa[f-1]=g&mask}greater(c,sa)||sub_(sa,c);copy_(a,sa)};/*
 http://www.gnu.org/licenses/gpl.html [GNU General Public License]
 @param {jQuery} {sha1:function(string))
 @return string
*/
function SHA256(a){function b(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function c(a,b){return a>>>b|a<<32-b}a=function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var g=a.charCodeAt(c);128>g?b+=String.fromCharCode(g):(127<g&&2048>g?b+=String.fromCharCode(g>>6|192):(b+=String.fromCharCode(g>>12|224),b+=String.fromCharCode(g>>6&63|128)),b+=String.fromCharCode(g&63|128))}return b}(a);return function(a){for(var b="",c=0;c<4*a.length;c++)b+="0123456789abcdef".charAt(a[c>>
2]>>8*(3-c%4)+4&15)+"0123456789abcdef".charAt(a[c>>2]>>8*(3-c%4)&15);return b}(function(a,e){var f=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,
2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],g=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],h=Array(64),m,l,q,p,u,n,r,A,v,x,y;a[e>>5]|=128<<24-e%32;a[(e+64>>9<<4)+15]=e;for(A=0;A<a.length;A+=16){e=g[0];m=g[1];l=g[2];q=g[3];
p=g[4];u=g[5];n=g[6];r=g[7];for(v=0;64>v;v++){if(16>v)h[v]=a[v+A];else{x=v;y=h[v-2];y=c(y,17)^c(y,19)^y>>>10;y=b(y,h[v-7]);var z;z=h[v-15];z=c(z,7)^c(z,18)^z>>>3;h[x]=b(b(y,z),h[v-16])}x=p;x=c(x,6)^c(x,11)^c(x,25);x=b(b(b(b(r,x),p&u^~p&n),f[v]),h[v]);r=e;r=c(r,2)^c(r,13)^c(r,22);y=b(r,e&m^e&l^m&l);r=n;n=u;u=p;p=b(q,x);q=l;l=m;m=e;e=b(x,y)}g[0]=b(e,g[0]);g[1]=b(m,g[1]);g[2]=b(l,g[2]);g[3]=b(q,g[3]);g[4]=b(p,g[4]);g[5]=b(u,g[5]);g[6]=b(n,g[6]);g[7]=b(r,g[7])}return g}(function(a){for(var b=[],c=0;c<
8*a.length;c+=8)b[c>>5]|=(a.charCodeAt(c/8)&255)<<24-c%32;return b}(a),8*a.length))}var hex_chr="0123456789abcdef";function hex(a){for(var b="",c=7;0<=c;c--)b+=hex_chr.charAt(a>>4*c&15);return b}function str2blks_SHA1(a){for(var b=(a.length+8>>6)+1,c=Array(16*b),d=0;d<16*b;d++)c[d]=0;for(d=0;d<a.length;d++)c[d>>2]|=a.charCodeAt(d)<<24-d%4*8;c[d>>2]|=128<<24-d%4*8;c[16*b-1]=8*a.length;return c}
function hex2blks_SHA1(a){for(var b=a.length+1>>1,c=(b+8>>6)+1,d=Array(16*c),e=0;e<16*c;e++)d[e]=0;for(e=0;e<b;e++)d[e>>2]|=parseInt(a.substr(2*e,2),16)<<24-e%4*8;d[e>>2]|=128<<24-e%4*8;d[16*c-1]=8*b;return d}function ba2blks_SHA1(a,b,c){for(var d=(c+8>>6)+1,e=Array(16*d),f=0;f<16*d;f++)e[f]=0;for(f=0;f<c;f++)e[f>>2]|=(a[b+f]&255)<<24-f%4*8;e[f>>2]|=128<<24-f%4*8;e[16*d-1]=8*c;return e}function sha1_add(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}
function rol(a,b){return a<<b|a>>>32-b}function ft(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d}function kt(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514}function bad_calcSHA1(a){return calcSHA1Blks(str2blks_SHA1(a))}function calcSHA1Hex(a){return calcSHA1Blks(hex2blks_SHA1(a))}function calcSHA1BA(a){return calcSHA1Blks(ba2blks_SHA1(a,0,a.length))}function calcSHA1BAEx(a,b,c){return calcSHA1Blks(ba2blks_SHA1(a,b,c))}
function calcSHA1Blks(a){a=calcSHA1Raw(a);return hex(a[0])+hex(a[1])+hex(a[2])+hex(a[3])+hex(a[4])}
function calcSHA1Raw(a){for(var b=Array(80),c=1732584193,d=-271733879,e=-1732584194,f=271733878,g=-1009589776,h=0;h<a.length;h+=16){for(var m=c,l=d,q=e,p=f,u=g,n=0;80>n;n++){var r;b[n]=16>n?a[h+n]:rol(b[n-3]^b[n-8]^b[n-14]^b[n-16],1);r=sha1_add(sha1_add(rol(c,5),ft(n,d,e,f)),sha1_add(sha1_add(g,b[n]),kt(n)));g=f;f=e;e=rol(d,30);d=c;c=r}c=sha1_add(c,m);d=sha1_add(d,l);e=sha1_add(e,q);f=sha1_add(f,p);g=sha1_add(g,u)}return[c,d,e,f,g]}
function core_sha1(a,b){a[b>>5]|=128<<24-b%32;a[(b+64>>9<<4)+15]=b;return calcSHA1Raw(a)}
var rotateLeft=function(a,b){return a<<b|a>>>32-b},lsbHex=function(a){var b="",c,d,e;for(c=0;6>=c;c+=2)d=a>>>4*c+4&15,e=a>>>4*c&15,b+=d.toString(16)+e.toString(16);return b},cvtHex=function(a){var b="",c,d;for(c=7;0<=c;c--)d=a>>>4*c&15,b+=d.toString(16);return b},uTF8Encode=function(a){a=a.replace(/\x0d\x0a/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):(127<d&&2048>d?b+=String.fromCharCode(d>>6|192):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>
6&63|128)),b+=String.fromCharCode(d&63|128))}return b};
function calcSHA1(a){var b,c,d=Array(80),e=1732584193,f=4023233417,g=2562383102,h=271733878,m=3285377520,l,q,p,u,n;a=uTF8Encode(a);l=a.length;var r=[];for(b=0;b<l-3;b+=4)c=a.charCodeAt(b)<<24|a.charCodeAt(b+1)<<16|a.charCodeAt(b+2)<<8|a.charCodeAt(b+3),r.push(c);switch(l%4){case 0:b=2147483648;break;case 1:b=a.charCodeAt(l-1)<<24|8388608;break;case 2:b=a.charCodeAt(l-2)<<24|a.charCodeAt(l-1)<<16|32768;break;case 3:b=a.charCodeAt(l-3)<<24|a.charCodeAt(l-2)<<16|a.charCodeAt(l-1)<<8|128}for(r.push(b);14!=
r.length%16;)r.push(0);r.push(l>>>29);r.push(l<<3&4294967295);for(a=0;a<r.length;a+=16){for(b=0;16>b;b++)d[b]=r[a+b];for(b=16;79>=b;b++)d[b]=rotateLeft(d[b-3]^d[b-8]^d[b-14]^d[b-16],1);c=e;l=f;q=g;p=h;u=m;for(b=0;19>=b;b++)n=rotateLeft(c,5)+(l&q|~l&p)+u+d[b]+1518500249&4294967295,u=p,p=q,q=rotateLeft(l,30),l=c,c=n;for(b=20;39>=b;b++)n=rotateLeft(c,5)+(l^q^p)+u+d[b]+1859775393&4294967295,u=p,p=q,q=rotateLeft(l,30),l=c,c=n;for(b=40;59>=b;b++)n=rotateLeft(c,5)+(l&q|l&p|q&p)+u+d[b]+2400959708&4294967295,
u=p,p=q,q=rotateLeft(l,30),l=c,c=n;for(b=60;79>=b;b++)n=rotateLeft(c,5)+(l^q^p)+u+d[b]+3395469782&4294967295,u=p,p=q,q=rotateLeft(l,30),l=c,c=n;e=e+c&4294967295;f=f+l&4294967295;g=g+q&4294967295;h=h+p&4294967295;m=m+u&4294967295}n=cvtHex(e)+cvtHex(f)+cvtHex(g)+cvtHex(h)+cvtHex(m);return n.toLowerCase()}
function btoa(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),c=0,d=0,e=a.length/3,f=[];c<e;++c){var g=a.charCodeAt(d++),h=a.charCodeAt(d++),m=a.charCodeAt(d++);if(255<(g|h|m))throw Error("String contains an invalid character");f[f.length]=b[g>>2]+b[g<<4&63|h>>4]+(isNaN(h)?"=":b[h<<2&63|m>>6])+(isNaN(h+m)?"=":b[m&63])}return f.join("")}
function hexToBase64(a){return btoa(String.fromCharCode.apply(null,a.replace(/\r|\n/g,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")))};var pN=str2bigInt("115b8b692e0e045692cf280b436735c77a5a9e8a9e7ed56c965f87db5b2a2ece3",16,0),pNBitsLen=264,pg=str2bigInt("02",16,0),pk=str2bigInt("dbe5dfe0704fee4c85ff106ecd38117d33bcfe50",16,0),pabBitsLen=256;function SRPClientContext(a,b){this.vS=a;this.vBbs=b;this.va=randBigInt(pabBitsLen,1);this.vA=powMod(pg,this.va,pN)}
SRPClientContext.prototype.makeAuthorizationData=function(a,b){b=calcSHA1(a+":"+(null==b?"":b));a=str2bigInt(this.vBbs,16,1);b=this.xCalculate(b,this.vS);var c=srp_compute_u(this.getAbytes(),this.vBbs);if(isZero(mod(a,pN))||isZero(c))throw"Bad SRP server data";var d=powMod(pg,b,pN),d=mult(d,pk);a=add(a,mult(pN,pk));a=sub(a,d);a=mod(a,pN);b=add(this.va,mult(b,c));a=powMod(a,b,pN);return calcSHA1Hex(bigInt2str(a,16))};SRPClientContext.prototype.getAbytes=function(){return bigInt2str(this.vA,16)};
SRPClientContext.prototype.xCalculate=function(a,b){a=calcSHA1Hex(b+a);a=str2bigInt(a,16);greater(a,pN)&&(a=mod(a,pN));return a};function srp_compute_u(a,b){var c=2*(pNBitsLen>>3);a=""+(srp_nzero(c-a.length)+a);a+=srp_nzero(c-b.length)+b;b=calcSHA1Hex(a);b=str2bigInt(b,16,0);greater(b,pN)&&(b=mod(b,pN));return b}function srp_nzero(a){if(1>a)return"";var b=srp_nzero(a>>1);return 0==(a&1)?b+b:b+b+"0"};var g_headers={Accept:"*/*","User-Agent":"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.75 Safari/537.36","Accept-Language":"ru,en;q=0.8",Origin:"https://online.skbbank.ru","Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},baseurl="https://online.skbbank.ru/",errors={BAD_CREDENTIALS:"Неправльное имя пользователя или пароль"};
function login(){function a(a){if(!/OK/i.test(a)){var b=errors[getParam(a,null,null,null,AB.replaceTagsAndSpaces)];if(b)throw new AnyBalance.Error(b,null,/Неправльное имя пользователя или пароль/i.test(b));AnyBalance.trace(a);throw new AnyBalance.Error("Не удалось зайти в интернет-банк. Сайт изменен?");}}var b=AnyBalance.getPreferences();AnyBalance.setDefaultCharset("utf-8");checkEmpty(b.login,"Введите логин!");checkEmpty(b.password,"Введите пароль!");AnyBalance.setOptions({SSL_ENABLED_PROTOCOLS:["TLSv1.2"]});
b.login=b.login.toLowerCase();var c=AnyBalance.requestGet(baseurl+"auto/html/index.html",g_headers);if(!c||400<AnyBalance.getLastStatusCode())throw AnyBalance.trace(c),new AnyBalance.Error("Ошибка при подключении к сайту интернет-банка! Попробуйте обновить данные позже.");if(/Подождите, идет загрузка.../i.test(c))AnyBalance.trace("Уже залогинены, используем существующую сессию");else{c=AnyBalance.requestPost(baseurl+"service/prelogin",{userName:b.login},addHeaders({Referer:baseurl+"ru/html/login.html"}));
AnyBalance.trace("BSS response: "+c);var d=c.split(";"),e=d[2],f=d[3],c=d[4],g=new SRPClientContext(d[0],d[1]),d=g.makeAuthorizationData(e,b.password),h=calcSHA1(b.password),m=g.makeAuthorizationData(e,h),e=g.makeAuthorizationData(e,calcSHA1(hexToBase64(h)+f)),f=g.getAbytes(),c=AnyBalance.requestPost(baseurl+"service/login",{userName:b.login,passwordData:d,passwordDataSHA:m,passwordDataSHASalt:e,extPasswordData:f,language:"ru",preloginId:c},addHeaders({Referer:baseurl+"ru/html/login.html"}));a(c);
c=AnyBalance.requestPost(baseurl+"ru/auth.rt",{userName:b.login,signId:""},addHeaders({Accept:"application/json, text/javascript, */*; q=0.01",Referer:baseurl+"ru/html/login.html","X-Requested-With":"XMLHttpRequest"}));a(c);c=AnyBalance.requestGet(baseurl+"service/postLogin",AB.addHeaders({"X-Requested-With":"XMLHttpRequest",Referer:baseurl+"ru/html/login.html"}));a(c);c=AnyBalance.requestGet(baseurl+"def/retail/login.rt",AB.addHeaders({Referer:baseurl+"ru/html/login.html"}));refreshFromABS(c)}if(!/BSSCore\.logout\(\)/i.test(c)){if(b=
errors[getParam(c,null,null,null,replaceTagsAndSpaces)])throw new AnyBalance.Error(b,null,/Неправльное имя пользователя или пароль/i.test(b));AnyBalance.trace(c);throw new AnyBalance.Error("Не удалось зайти в интернет-банк. Сайт изменен?");}__setLoginSuccessful();return c}
function refreshFromABS(a){var b=getParam(a,null,null,/var\s+JSID\s*=\s*'([^']+)/i);if(!b)throw AnyBalance.trace(a),new AnyBalance.Error("Не удалось найти идентификатор сессии. Сайт изменен?");AnyBalance.trace("Обновляем данные из АБС");a=1;do{if(getInfoJson("ru/retail/importabs.rt",b,{product:"mainpage",forceUpdate:"false"}).data[0].flag){AnyBalance.trace("Обновление успешно");break}if(10<a){AnyBalance.trace("Обновление неуспешно. Показываем, что есть.");break}AnyBalance.trace("Пока не обновилось. Делаем попытку "+
++a);AnyBalance.sleep(3E3)}while(1)}function getInfoJson(a,b,c){c||(c={});b=AnyBalance.requestPost(baseurl+a,joinObjects(c,{JSID:b}),addHeaders({Referer:baseurl+"auto/html/index.html","X-Requested-With":"XMLHttpRequest"}));try{var d=getJson(b)}catch(e){AnyBalance.trace("Error calling bank api ("+a+"): "+e.message),d={data:{}}}return d}
function processAccounts(a,b){if(AnyBalance.isAvailable("accounts")&&(a=getParam(a,null,null,/var\s+JSID\s*=\s*'([^']+)/i),isset(a))){a=getInfoJson("ru/retail/accounts.rt",a).data[0].accounts;AnyBalance.trace("Найдено счетов: "+a.length);b.accounts=[];for(var c=0;c<a.length;++c){var d=a[c],e=d.benefacc,d={__id:e,__name:d.acctype+" "+e+" "+d.curr,num:d.acc};__shouldProcess("accounts",d);b.accounts.push(d)}}}
function processAccount(a,b){AnyBalance.trace("Обработка счета "+b.__name);getParam(a.acctype,b,"accounts.type");getParam(a.balance,b,"accounts.balance",null,null,parseBalanceSilent);getParam(a.currency,b,["accounts.currency","accounts.balance"],null,null,parseCurrency);getParam(a.date,b,"accounts.date_start",null,null,parseDateWord);AnyBalance.isAvailable("accounts.transactions")&&processAccountTransactions(html,b)}
function processCards(a,b){if(AnyBalance.isAvailable("cards")){var c=getParam(a,null,null,/var\s+JSID\s*=\s*'([^']+)/i);if(isset(c))if(c=getInfoJson("ru/retail/cards?r=version:%202.2.0.167.SKBrevision:%204697c8e2d4d862a3289a93bdb56d5741d290a3c5",c),c.data[0].cardsList)for(a=c.data[0].cardsList,AnyBalance.trace("Найдено карт: "+a.length),b.cards=[],c=0;c<a.length;++c){var d=a[c],e=d.number,e={__id:d.id,__name:e+" "+d.name,num:e};__shouldProcess("cards",e)&&processCard(d,e);b.cards.push(e)}else/У вас нет карт/i.test(a)?
(AnyBalance.trace("У вас нет карт"),b.cards=[]):(AnyBalance.trace(JSON.stringify(c)),AnyBalance.trace("Не удалось найти таблицу с картами."))}}
function processCard(a,b){AnyBalance.trace("Обработка карты "+b.__name);getParam(a.amount,b,"cards.amount",null,replaceTagsAndSpaces,parseBalanceSilent);getParam(a.balance,b,"cards.balance",null,replaceTagsAndSpaces,parseBalanceSilent);getParam(a.creditLimit,b,"cards.limit",null,replaceTagsAndSpaces,parseBalanceSilent);getParam(a.currCode,b,["cards.currency","cards.balance","cards.amount","cards.limit"],null,replaceTagsAndSpaces);getParam(a.validDate+"",b,"cards.till",null,replaceTagsAndSpaces,parseDateWord);
getParam(a.holderName,b,"cards.holderName",null,replaceTagsAndSpaces);getParam(a.cardAccount,b,"cards.acc_num");getParam(a.name,b,"cards.name");getParam(a.cardSort,b,"cards.type",null,replaceTagsAndSpaces);isAvailable("cards.transactions")&&processCardTransactions(a,b)}
function processDeposits(a,b){if(AnyBalance.isAvailable("deposits")&&(a=getParam(a,null,null,/var\s+JSID\s*=\s*'([^']+)/i),isset(a))){a=getInfoJson("ru/retail/deposits?r=version:%202.2.0.167.SKBrevision:%204697c8e2d4d862a3289a93bdb56d5741d290a3c5",a).data[0].accounts;AnyBalance.trace("Найдено депозитов: "+a.length);b.deposits=[];for(var c=0;c<a.length;++c){var d=a[c],e={__id:d.id,__name:d.name,num:d.account};__shouldProcess("deposits",e)&&processDeposit(d,e);b.deposits.push(e)}}}
function processDeposit(a,b){AnyBalance.trace("Обработка депозита "+b.__name);getParam(a.amount,b,"deposits.balance",null,replaceTagsAndSpaces,parseBalanceSilent);getParam(a.currIso,b,["deposits.currency","deposits.balance"]);getParam(a.dateClose,b,"deposits.till",null,replaceTagsAndSpaces,parseDateSilent);getParam(a.interestRate,b,"deposits.pct",null,replaceTagsAndSpaces,parseBalanceSilent);isAvailable("deposits.transactions")&&processDepositTransactions(a,b)}
function processInfo(a,b){function c(a){a=AnyBalance.requestPost(baseurl+"ru/retail/personalData/fillBlock.rt",{JSID:d,blockNumber:a},addHeaders({Referer:baseurl+"auto/html/index.html","X-Requested-With":"XMLHttpRequest"}));try{var b=getJson(a)}catch(c){b={data:{}}}return b}var d=getParam(a,null,null,/var\s+JSID\s*=\s*'([^']+)/i);isset(d)&&(a=b.info={},b=c("1"),getParam(b.data.nameFull,a,"info.fio"),b=c("2"),getParam(b.data.birthDate,a,"info.birthday",null,replaceTagsAndSpaces,parseDate),getParam(b.data.birthPlace,
a,"info.birthPlace",null,replaceTagsAndSpaces),getParam(b.data.citizenship,a,"info.citizenship",null,replaceTagsAndSpaces),b=c("3"),getParam(b.data.passportSeries,a,"info.passportSeries",null,replaceTagsAndSpaces),getParam(b.data.passportNumber,a,"info.passport",null,replaceTagsAndSpaces),getParam(b.data.passportDate,a,"info.passportDate",null,replaceTagsAndSpaces,parseDate),getParam(b.data.passportPlace,a,"info.passportPlace",null,replaceTagsAndSpaces),b=c("5"),getParam(b.data.mobilePhone,a,"info.mphone",
null,replaceTagsAndSpaces),getParam(b.data.workPhone,a,"info.wphone",null,replaceTagsAndSpaces),getParam(b.data.email,a,"info.email",null,replaceTagsAndSpaces))};
