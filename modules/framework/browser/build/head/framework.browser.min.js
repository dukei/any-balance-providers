var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(e){return e.raw=e};$jscomp.createTemplateTagFirstArgWithRaw=function(e,a){e.raw=a;return e};
var BrowserAPI=function(){var e=function(a){this.options=a;this.headerMatchCounts=[]};e.prototype.requestAPI=function(a,b){var c=this.options.debug?"http://localhost:4024":this.options.win?"https://browin.anybalance.ru":"http://browser.anybalance.ru:4024";b=b?AnyBalance.requestPost(c+"/"+a,JSON.stringify(b),{Referer:this.options.provider+"","Content-Type":"application/json"}):AnyBalance.requestGet(c+"/"+a+(0<=a.indexOf("?")?"&":"?")+"_="+ +new Date,{Referer:this.options.provider+""});c=JSON.parse(b);
if("ok"!==c.status)throw AnyBalance.trace(b),new AnyBalance.Error("Ошибка browser api ("+a+"): "+c.message);return c};e.prototype.open=function(a){var b=this.requestAPI("base/open",{userAgent:this.options.userAgent,singlePage:this.options.singlePage,headful:this.options.headful,url:a,rules:this.options.rules});AnyBalance.trace("Opening page "+a+": "+b.page);return b};e.prototype.waitForLoad=function(a){var b=0;do{++b;AnyBalance.sleep(3E3);var c=this.requestAPI("base/status?page="+a);AnyBalance.trace("Loading status of page "+
a+": "+c.loadStatus+" (попытка "+b+")");if(c.pendingRequests&&0<c.pendingRequests.length)for(var p=0;p<c.pendingRequests.length;++p){var g=c.pendingRequests[p],n=[],q;for(q in g.headers){var f=g.headers[q];if(""!==f.trim()){f=f.split("\n");for(var d=0;d<f.length;++d)n.push([q,f[d]])}}f={};if(this.options.additionalRequestHeaders)for(d=0;d<this.options.additionalRequestHeaders.length;++d){var h=this.options.additionalRequestHeaders[d];if(!h.url||h.url.test(g.url)){var l=this.headerMatchCounts;if(!h.maxCount||
(l[d]||0)<h.maxCount){f=h.headers||{};h.maxCount&&(l[d]=(l[d]||0)+1);break}}}n=AnyBalance.requestPost(g.url,g.body,addHeaders(f,n),{HTTP_METHOD:g.method});f=AnyBalance.getLastResponseParameters();d={};h=void 0;for(l=0;l<f.headers.length;++l){var m=f.headers[l],k=m[0].toLowerCase();0<=["transfer-encoding","content-encoding"].indexOf(k)||("content-length"===k&&(m[1]=""+unescape(encodeURIComponent(n||"")).length),void 0===d[k]?d[k]=m[1]:Array.isArray(d[k])?d[k].push(m[1]):d[k]+=[m[1]],"content-type"===
k&&(h=m[1]))}g={id:g.id,page:a,r:{status:AnyBalance.getLastStatusCode(),headers:d,contentType:h,body:n}};this.requestAPI("base/response",g)}else if("load"===c.loadStatus)break}while(15>b);if("load"!==c.loadStatus)throw new AnyBalance.Error("Waiting for page "+a+" loading timeout!");};e.prototype.content=function(a){return this.requestAPI("base/content?page="+a)};e.prototype.cookies=function(a,b){b&&(Array.isArray(b)||(b=[b]));return this.requestAPI("base/cookies",{page:a,urls:b})};e.prototype.close=
function(a){return this.requestAPI("base/close",{page:a})};e.useCookies=function(a){for(var b=0;b<a.length;++b){var c=a[b];AnyBalance.setCookie(c.domain,c.name,c.value,c)}};return e}();
