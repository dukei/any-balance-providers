function loginYandex(e,f,a,c,d){function g(a){return getParam(a,null,null,/<input[^>]*name="idkey"[^>]*value="([^"]*)/i)}var b="https://passport.yandex.ru/passport?mode=auth";d&&(b+="&from="+encodeURIComponent(d));c&&(b+="&retpath="+encodeURIComponent(c));a||(a=AnyBalance.requestGet(b,g_headers));a=(a=g(a))?AnyBalance.requestPost(b,{from:d||"passport",retpath:c,idkey:a,display:"page",login:e,passwd:f,timestamp:(new Date).getTime()},g_headers):AnyBalance.requestPost(b,{retpath:c,login:e,passwd:f},
addHeaders({Referer:b}));var h=getParam(a,null,null,/<img[^>]+captcha__text[^>]*src="([^"]*)/i,replaceHtmlEntities);!/logout/i.test(a)&&h&&(c=AnyBalance.getLastUrl(),AnyBalance.trace("Затребована капча, придется показывать"),a=AB.createFormParams(a,function(a,b,c,d){return"login"==c?e:"passwd"==c?f:"answer"==c?(a=AnyBalance.requestGet(h,g_headers),AnyBalance.retrieveCode("Пожалуйста, введите символы с картинки",a)):d}),a=AnyBalance.requestPost(c,a,addHeaders({Referer:c})));if(!/logout/i.test(a)){if(b=
getParam(a,null,null,[/b\-login\-error[^>]*>([\s\S]*?)<\/strong>/i,/error-msg[^>]*>([^<]+)/i],replaceTagsAndSpaces,html_entity_decode))throw new AnyBalance.Error(b,null,/Учётной записи с таким логином не существует|Неправильная пара логин-пароль|Неправильный логин или пароль|Нет аккаунта с таким логином/i.test(b));if(/Нам пришлось заблокировать ваш IP/i.test(a))throw new AnyBalance.Error("Яндекс временно заблокировал ваш IP. Возможно, с этого IP было много входов. Пожалуйста, подождите часок и попробуйте ещё раз.");
AnyBalance.trace(a);throw new AnyBalance.Error("Не удалось зайти в личный кабинет Яндекса. Сайт изменен?");}/Установить постоянную авторизацию на(?:\s|&nbsp;)+данном компьютере\?/i.test(a)&&(AnyBalance.trace("Яндекс спрашивает, нужно ли запоминать этот компьютер. Отвечаем, что нет... (idkey="+g(a)+")"),a=AnyBalance.requestPost(b,{filled:"yes",timestamp:(new Date).getTime(),idkey:g(a),no:1},g_headers));return a};
