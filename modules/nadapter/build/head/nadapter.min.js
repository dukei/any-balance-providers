function NAdapter(l,w,g){function x(a){isArray(a)||(a=[a]);for(var b=0;b<a.length;++b){if(n[a[b]])return!0;if(g.autoSimpleCounters&&0>a[b].indexOf("."))return r.call(AnyBalance,a[b])}return!1}function y(a){for(var b=0;b<arguments.length;++b)if(x(arguments[b]))return!0;return!1}function t(a,b){return a.reduce(function(a,d){return a||d.__id!=b?a:d},null)}function u(a,b){for(var c=b.split(/\./g),d,f=0;f<c.length;++f){d=a[c[f]];b=c.slice(0,f+1).join(".");a=d;p[b]?d=p[b](a,b):(isArray(a)&&(a=e[b]&&a[0]&&
a[0].__id?t(a,e[b]):a[0]),d=a);if(!isset(d)||null===d)break;a=d}return d}function v(a,b){AnyBalance.isAvailable=y;try{return a.apply(null,b)}finally{AnyBalance.isAvailable=r}}var n={},r=AnyBalance.isAvailable;g||(g={});var p={},m;for(m in l)if(/^!/.test(m)||isAvailable(m)){var h=l[m];isArray(h)||(h=[h]);for(var q=0;q<h.length;++q){var k=h[q];do n[k]=!0,k=0<=k.indexOf(".")?k.replace(/\.[^.]*$/,""):null;while(null!==k)}}var e={};AnyBalance.shouldProcess=function(a,b){var c=g.shouldProcessMultipleCalls,
c="object"==typeof c?c[a]:c;if(!c&&e[a])return b.__id==e[a];if(c=w(a,b))e[a]=b.__id;return c};return{exec:v,convert:function(a){if(!a.success)return a;var b={success:!0};if(g.autoSimpleCounters)for(var c in a)n[c]||isArray(a[c])||(b[c]=a[c]);for(c in l)if("__forceAvailable"!=c&&(/^!/.test(c)||isAvailable(c))){var d=l[c];isArray(d)||(d=[d]);for(var f=0;f<d.length;++f){var e=u(a,d[f]);if(isset(e)){b[c.replace(/^[^\w]+/g,"")]=e;break}}}return b},envelope:function(a){return function(){return v(a,arguments)}},
traverse:u,wasProcessed:function(a){return e[a]},setTraverseCallbacks:function(a){for(var b in a)p[b]=a[b]},findEntityById:t}};
