"object"===typeof exports&&this==exports&&(module.exports=EasySAXParser);
function EasySAXParser(){function r(){}function Q(b,f,l,h){return h?R[h]||"":f?String.fromCharCode(f):String.fromCharCode(parseInt(l,16))}function v(b,f){b=String(b);3<b.length&&-1!==b.indexOf("&")&&(-1!==b.indexOf("&gt;")&&(b=b.replace(/&gt;/g,">")),-1!==b.indexOf("&lt;")&&(b=b.replace(/&lt;/g,"<")),-1!==b.indexOf("&quot;")&&(b=b.replace(/&quot;/g,'"')),-1!==b.indexOf("&")&&(b=b.replace(/&#(\d+);|&#x([0123456789abcdef]+);|&(\w+);/ig,Q)));return b}function C(){if(null!==p)return p;var b={},f=z,l=
A,t=f.length,k=w?[]:!1,g,q="",d=!1,c,a,m,n,e;a:for(;l<t;l++)if(a=f.charCodeAt(l),!(32===a||14>a&&8<a)){if(65>a||122<a||90<a&&97>a)return p=!1;for(c=l+1;c<t;c++)if(a=f.charCodeAt(c),!(96<a&&123>a||64<a&&91>a||47<a&&59>a||45===a||95===a)){if(61!==a)return p=!1;break}g=f.substring(l,c);d=!0;if("xmlns:xmlns"===g)return p=!1;a=f.charCodeAt(c+1);if(34===a)c=f.indexOf('"',l=c+2);else if(39===a)c=f.indexOf("'",l=c+2);else return p=!1;if(-1===c||c+1<t&&(a=f.charCodeAt(c+1),32<a||9>a||32>a&&13<a))return p=
!1;q=f.substring(l,c);l=c+1;if(x){if(w){if(e="xmlns"===g?"xmlns":120===g.charCodeAt(0)&&"xmlns:"===g.substr(0,6)&&g.substr(6)){if(a=D[v(q)]){if(h[e]!==a){if(!n){n=!0;c={};for(m in h)c[m]=h[m];h=c}h[e]=a}}else if(h[e]){if(!n){n=!0;c={};for(m in h)c[m]=h[m];h=c}h[e]=!1}b[g]=q;continue}k.push(g,q);continue}for(a=g.length;--a;)if(58===g.charCodeAt(a)){if(a=h[g.substring(0,a)])b[a+g.substr(a)]=q;continue a}}b[g]=q}if(!d)return p=!0;if(w)a:for(l=0,t=k.length;l<t;l++){g=k[l++];for(a=g.length;--a;)if(58===
g.charCodeAt(a)){if(a=h[g.substring(0,a)])b[a+g.substr(a)]=k[l];continue a}b[g]=k[l]}return p=b}function E(b){function f(){return b.substring(c,d+1)}b=String(b);for(var l=[],t=[],k,g=!1,q=!1,d=0,c=0,a,r,n,e,u,y=0,B;-1!==d;){u=0<y;c=60===b.charCodeAt(d)?d:b.indexOf("<",d);if(-1===c){l.length&&m("end file");break}if(d!==c&&!u&&(a=F(b.substring(d,c),v),!1===a))break;e=b.charCodeAt(c+1);if(33===e)if(e=b.charCodeAt(c+2),91===e&&"CDATA["===b.substr(c+3,6)){d=b.indexOf("]]\x3e",c);if(-1===d){m("cdata");
break}if(!u&&(a=G(b.substring(c+9,d),!1),!1===a))break;d+=3}else if(45===e&&45===b.charCodeAt(c+3)){d=b.indexOf("--\x3e",c);if(-1===d){m("expected --\x3e");break}if(H&&!u&&(a=I(b.substring(c+4,d),v),!1===a))break;d+=3}else{d=b.indexOf(">",c+1);if(-1===d){m('expected ">"');break}if(J&&!u&&(a=K(b.substring(c,d+1),v),!1===a))break;d+=1}else if(63===e){d=b.indexOf("?>",c);if(-1===d){m("...?>");break}if(L&&(a=M(b.substring(c,d+2)),!1===a))break;d+=2}else{d=b.indexOf(">",c+1);if(-1==d){m("...>");break}p=
!0;if(47===e){q=!1;g=!0;a=k=l.pop();n=c+2+a.length;if(b.substring(c+2,n)!==a){m("close tagname");break}for(;n<d;n++)if(e=b.charCodeAt(n),!(32===e||8<e&&14>e)){m("close tag");return}}else{47===b.charCodeAt(d-1)?(a=k=b.substring(c+1,d-1),g=q=!0):(a=k=b.substring(c+1,d),q=!0,g=!1);if(!(96<e&&123>e||64<e&&91>e)){m("first char nodeName");break}n=1;for(r=a.length;n<r;n++)if(e=a.charCodeAt(n),!(96<e&&123>e||64<e&&91>e||47<e&&59>e||45===e||95===e)){if(32===e||14>e&&8<e){k=a.substring(0,n);p=null;break}m("invalid nodeName");
return}g||l.push(k)}if(x){if(u){g?q||0===--y&&(h=t.pop()):y+=1;d+=1;continue}B=h;g||(t.push(h),!0!==p&&(w=-1!==a.indexOf("xmlns",n))&&(z=a,A=n,C(),w=!1));e=k.indexOf(":");-1!==e?(u=h[k.substring(0,e)],k=k.substr(e+1)):u=h.xmlns;if(!u){g?h=q?B:t.pop():(y=1,p=!0);d+=1;continue}k=u+":"+k}if(q){z=a;A=n;a=N(k,C,v,g,f);if(!1===a)break;p=!0}if(g){a=O(k,v,q,f);if(!1===a)break;x&&(h=q?B:t.pop())}d+=1}}}if(!this)return null;var F=r,N=r,O=r,G=r,m=r,I,M,K,H,L,J,x=!1,D,P,h={xmlns:void 0},w=!1;this.on=function(b,
f){if("function"===typeof f||null===f)switch(b){case "error":m=f||r;break;case "startNode":N=f||r;break;case "endNode":O=f||r;break;case "textNode":F=f||r;break;case "cdata":G=f||r;break;case "comment":I=f;H=!!f;break;case "question":M=f;L=!!f;break;case "attention":K=f,J=!!f}};this.ns=function(b,f){if(b&&"string"===typeof b&&f){var h={},m,k,g;for(g in f)k=f[g],"string"===typeof k&&(b===k&&(m=!0),h[g]=k);m&&(x=!0,P=b,D=h)}};this.parse=function(b){"string"===typeof b&&(x?(h={xmlns:P},E(b),h=!1):E(b),
p=!0)};var R={constructor:!1,hasOwnProperty:!1,isPrototypeOf:!1,propertyIsEnumerable:!1,toLocaleString:!1,toString:!1,valueOf:!1,quot:'"',QUOT:'"',amp:"&",AMP:"&",nbsp:" ",apos:"'",lt:"<",LT:"<",gt:">",GT:">",copy:"©",laquo:"«",raquo:"»",reg:"®",deg:"°",plusmn:"±",sup2:"²",sup3:"³",micro:"µ",para:"¶"},z="",A=0,p};
