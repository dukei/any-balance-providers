(function(h,l){function m(a,c){a=a.slice();a.push(c);return a}function n(a,c){c=c.slice();c.unshift(a);return c}function f(a,c,b){if(!(this instanceof f))try{return new f(a,c,b)}catch(k){if(!k.avoidNew)throw k;return k.value}a=a||{};var d=a.hasOwnProperty("json")&&a.hasOwnProperty("path");this.resultType=a.resultType&&a.resultType.toLowerCase()||"value";this.flatten=a.flatten||!1;this.wrap=a.hasOwnProperty("wrap")?a.wrap:!0;this.sandbox=a.sandbox||{};if(!1!==a.autostart&&(a=this.evaluate(d?a.json:
c,d?a.path:b),!a||"object"!==typeof reg))throw{avoidNew:!0,value:a,message:"JSONPath should not be called with 'new'"};}Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});var q="undefined"!==typeof module&&module.exports?h("vm"):{runInNewContext:function(a,c){return eval(Object.keys(c).reduce(function(a,d){return"var "+d+"="+JSON.stringify(c[d])+";"+a},a))}},p={};f.prototype.evaluate=function(a,c){var b=this;this._obj=a;if(c&&a&&("value"===this.resultType||
"path"===this.resultType)){var d=this._normalize(c);"$"===d[0]&&1<d.length&&d.shift();d=this._trace(d,a,["$"]);d=d.filter(function(a){return a&&!a.isParentSelector});return d.length?1!==d.length||this.wrap||Array.isArray(d[0].value)?d.reduce(function(a,c){var d=c[b.resultType];"path"===b.resultType&&(d=b._asPath(d));b.flatten&&Array.isArray(d)?a=a.concat(d):a.push(d);return a},[]):d[0][this.resultType]||!1:this.wrap?[]:!1}};f.prototype._normalize=function(a){if(p[a])return p[a];var c=[],b=a.replace(/[\['](\??\(.*?\))[\]']/g,
function(a,b){return"[#"+(c.push(b)-1)+"]"}).replace(/'?\.'?(?![^\[]*\])|\['?/g,";").replace(/(?:;)?(\^+)(?:;)?/g,function(a,c){return";"+c.split("").join(";")+";"}).replace(/;;;|;;/g,";..;").replace(/;$|'?\]|'$/g,"").split(";").map(function(a){var b=a.match(/#([0-9]+)/);return b&&b[1]?c[b[1]]:a});p[a]=b;return p[a]};f.prototype._asPath=function(a){var c,b,d="$";c=1;for(b=a.length;c<b;c++)d+=/^[0-9*]+$/.test(a[c])?"["+a[c]+"]":"['"+a[c]+"']";return d};f.prototype._trace=function(a,c,b){function d(a){g=
g.concat(a)}var k=this;if(!a.length)return[{path:b,value:c}];var e=a[0];a=a.slice(1);if("^"===e)return b.length?[{path:b.slice(0,-1),expr:a,isParentSelector:!0}]:[];var g=[];if(c&&c.hasOwnProperty(e))d(this._trace(a,c[e],m(b,e)));else if("*"===e)this._walk(e,a,c,b,function(a,c,b,e,f){d(k._trace(n(a,b),e,f))});else if(".."===e)d(this._trace(a,c,b)),this._walk(e,a,c,b,function(a,c,b,e,f){"object"===typeof e[a]&&d(k._trace(n("..",b),e[a],m(f,a)))});else if("("===e[0])d(this._trace(n(this._eval(e,c,b[b.length],
b),a),c,b));else if(0===e.indexOf("?("))this._walk(e,a,c,b,function(a,c,e,f,g){k._eval(c.replace(/^\?\((.*?)\)$/,"$1"),f[a],a,b)&&d(k._trace(n(a,e),f,g))});else if(-1<e.indexOf(",")){var f,e=e.split(",");for(f=0;f<e.length;f++)d(this._trace(n(e[f],a),c,b))}else/^(-?[0-9]*):(-?[0-9]*):?([0-9]*)$/.test(e)&&d(this._slice(e,a,c,b));return g.reduce(function(a,b){return a.concat(b.isParentSelector?k._trace(b.expr,c,b.path):[b])},[])};f.prototype._walk=function(a,c,b,d,f){var e,g;if(Array.isArray(b))for(e=
0,g=b.length;e<g;e++)f(e,a,c,b,d);else if("object"===typeof b)for(e in b)b.hasOwnProperty(e)&&f(e,a,c,b,d)};f.prototype._slice=function(a,c,b,d){if(Array.isArray(b)){var f,e=b.length,g=a.split(":");f=g[0]&&parseInt(g[0],10)||0;a=g[1]&&parseInt(g[1],10)||e;g=g[2]&&parseInt(g[2],10)||1;f=0>f?Math.max(0,f+e):Math.min(e,f);a=0>a?Math.max(0,a+e):Math.min(e,a);for(e=[];f<a;f+=g)e=e.concat(this._trace(n(f,c),b,d));return e}};f.prototype._eval=function(a,c,b,d){if(!this._obj||!c)return!1;-1<a.indexOf("@path")&&
(this.sandbox._$_path=this._asPath(d.concat([b])),a=a.replace(/@path/g,"_$_path"));-1<a.indexOf("@")&&(this.sandbox._$_v=c,a=a.replace(/@/g,"_$_v"));try{return q.runInNewContext(a,this.sandbox)}catch(f){throw console.log(f),Error("jsonPath: "+f.message+": "+a);}};f.eval=function(a,c,b){return f(b,a,c)};"undefined"===typeof module?(l.jsonPath={eval:f.eval},l.JSONPath=f):module.exports=f})("undefined"===typeof require?null:require,this);function jspath(h,l,m){if("$"==l)return[h];h=JSONPath(null,h,l);return h.length?h:m}function jspath1(h,l,m){if("$"==l)return h;h=JSONPath(null,h,l);return h.length?h[0]:m};
